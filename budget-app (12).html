<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Budget Tracker">
    <meta name="theme-color" content="#FFD700">
    
    <!-- Preload Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- App Icon - Fel Geel met B -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' fill='%23FFD700'/><text x='256' y='365' font-family='system-ui, -apple-system, sans-serif' font-size='340' fill='%23000000' text-anchor='middle' font-weight='900'>B</text></svg>">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' fill='%23FFD700'/><text x='256' y='365' font-family='system-ui, -apple-system, sans-serif' font-size='340' fill='%23000000' text-anchor='middle' font-weight='900'>B</text></svg>">
    <title>Budget Tracker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap&text=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789‚Ç¨.,-!?WELCOME');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-yellow: #FFD700;
            --secondary-yellow: #FFA500;
            --dark-bg: #0a0a0a;
            --card-bg: #1a1a1a;
            --border-color: #FFD700;
            --text-primary: #FFD700;
            --text-secondary: #ffffff;
            --success: #00ff00;
            --warning: #ff3333;
            --grid-color: rgba(255, 215, 0, 0.1);
            --month-accent: #FFD700;
        }

        [data-theme="light"] {
            --dark-bg: #f5f5f5;
            --card-bg: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #333333;
            --border-color: #1a1a1a;
            --grid-color: rgba(0, 0, 0, 0.05);
            --success: #00aa00;
            --warning: #ff0000;
            --month-accent: #1a1a1a;
        }

        body {
            font-family: 'Share Tech Mono', 'Courier New', Courier, monospace;
            background: var(--dark-bg);
            color: var(--text-secondary);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(0deg, var(--grid-color) 0px, transparent 1px, transparent 20px),
                repeating-linear-gradient(90deg, var(--grid-color) 0px, transparent 1px, transparent 20px);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
            padding-bottom: 100px;
        }

        h1, h2, h3 {
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        h1 {
            font-size: 1.2rem;
            font-weight: 700;
            text-align: center;
            margin: 20px 0 10px 0;
            color: #FFD700 !important;
            text-shadow: 0 0 10px #FFD700;
            opacity: 0.7;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px var(--primary-yellow); }
            50% { text-shadow: 0 0 30px var(--primary-yellow), 0 0 40px var(--secondary-yellow); }
        }

        .card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 0;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            box-shadow: 5px 5px 0 var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translate(-2px, -2px);
            box-shadow: 7px 7px 0 var(--border-color), 0 0 20px var(--month-accent);
        }

        .card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--primary-yellow), var(--secondary-yellow));
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card:hover::before {
            opacity: 0.1;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-box::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--primary-yellow), transparent);
            opacity: 0.1;
            transition: left 0.5s;
        }

        .stat-box:hover::after {
            left: 100%;
        }

        .stat-label {
            font-size: 0.7rem;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-yellow);
            margin-top: 5px;
        }

        .progress-bar {
            height: 30px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            position: relative;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-yellow), var(--secondary-yellow));
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-weight: 700;
            color: #ffffff;
            font-size: 0.9rem;
            text-shadow: 0 0 4px rgba(0,0,0,0.8), 0 0 8px rgba(0,0,0,0.6);
            z-index: 2;
        }

        button {
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            background: var(--dark-bg);
            color: var(--primary-yellow);
            border: 2px solid var(--border-color);
            padding: 12px 24px;
            font-size: 0.9rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: var(--primary-yellow);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        button:active::before {
            width: 300px;
            height: 300px;
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button:hover {
            background: var(--primary-yellow);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--primary-yellow);
        }

        input[type="number"], input[type="text"], input[type="password"] {
            font-family: 'Share Tech Mono', 'Courier New', Courier, monospace;
            background: var(--dark-bg);
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
            padding: 12px;
            font-size: 1rem;
            width: 100%;
            margin: 10px 0;
        }

        input:focus {
            outline: none;
            box-shadow: 0 0 20px var(--primary-yellow);
            background: var(--card-bg);
        }

        input::placeholder {
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .quick-add {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .quick-btn {
            padding: 15px 10px;
            font-size: 1.1rem;
        }

        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-bg);
            border-top: 2px solid var(--border-color);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.7rem;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            opacity: 0.6;
        }

        .nav-btn:hover, .nav-btn.active {
            color: var(--primary-yellow);
            transform: translateY(-2px);
            opacity: 1;
        }

        .nav-btn.active {
            background: rgba(255, 215, 0, 0.1);
            border-top: 2px solid var(--primary-yellow);
        }

        .nav-icon {
            font-size: 1.5rem;
        }

        .hidden {
            display: none !important;
        }

        .achievement {
            background: linear-gradient(135deg, var(--primary-yellow), var(--secondary-yellow));
            color: var(--dark-bg);
            padding: 15px;
            margin: 10px 0;
            border-radius: 0;
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-weight: 700;
            text-align: center;
            animation: slideIn 0.5s ease;
            box-shadow: 0 0 20px var(--primary-yellow);
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            background: var(--primary-yellow);
            color: var(--dark-bg);
            font-size: 0.8rem;
            font-weight: 700;
            margin: 5px;
            text-transform: uppercase;
        }

        .alert {
            background: var(--warning);
            color: white;
            padding: 15px;
            margin: 10px 0;
            border-left: 5px solid #cc0000;
            animation: pulse 2s infinite;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.4);
            border-radius: 0;
            border: 2px solid var(--warning);
        }

        @keyframes pulse {
            0%, 100% { 
                opacity: 1;
                box-shadow: 0 4px 15px rgba(255, 51, 51, 0.4);
            }
            50% { 
                opacity: 0.9;
                box-shadow: 0 4px 25px rgba(255, 51, 51, 0.6);
            }
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin: 20px 0;
        }

        .day-cell {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 10px 5px;
            text-align: center;
            font-size: 0.8rem;
            position: relative;
        }

        .day-cell.today {
            background: var(--primary-yellow);
            color: var(--dark-bg);
            font-weight: 700;
            border: 2px solid var(--primary-yellow);
        }

        .day-cell.over-budget {
            background: var(--warning);
            color: white;
            border: 2px solid var(--warning);
            font-weight: 700;
        }

        .day-cell.over-budget::before {
            content: '‚úó';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7rem;
        }

        .day-cell.under-budget {
            background: var(--success);
            color: var(--dark-bg);
            border: 2px solid var(--success);
            font-weight: 700;
        }

        .day-cell.under-budget::before {
            content: '‚úì';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7rem;
            font-weight: 900;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-yellow);
            border: 3px solid var(--border-color);
            color: var(--dark-bg);
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 0 20px var(--primary-yellow);
        }

        .theme-toggle:active {
            transform: rotate(180deg) scale(0.95);
        }

        .calculator {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            padding: 20px;
            margin: 20px 0;
        }

        .calc-display {
            background: var(--dark-bg);
            border: 2px solid var(--border-color);
            padding: 15px;
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-size: 1.5rem;
            text-align: right;
            margin-bottom: 10px;
            min-height: 50px;
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .calc-btn {
            padding: 20px;
            font-size: 1.2rem;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            animation: fadeIn 0.3s;
            transition: opacity 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--card-bg);
            border: 3px solid var(--border-color);
            padding: 30px;
            max-width: 400px;
            width: 90%;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 100%;
            gap: 10px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(to top, var(--primary-yellow), var(--secondary-yellow));
            position: relative;
            transition: all 0.5s ease;
            min-height: 20px;
            border: 2px solid var(--border-color);
        }

        .bar:hover {
            opacity: 0.8;
            transform: scaleY(1.05);
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            white-space: nowrap;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-weight: 700;
            color: var(--primary-yellow);
            font-size: 0.8rem;
        }

        .list-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .list-item:hover {
            transform: translateX(5px);
            border-left: 5px solid var(--primary-yellow);
        }

        .editable {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-family: 'Share Tech Mono', 'Courier New', Courier, monospace;
            font-size: 1rem;
            text-align: right;
            width: 100px;
            font-weight: 700;
        }

        .editable:focus {
            background: var(--dark-bg);
            outline: 2px solid var(--primary-yellow);
        }

        .category-tag {
            display: inline-block;
            padding: 3px 8px;
            background: var(--border-color);
            color: var(--dark-bg);
            font-size: 0.7rem;
            margin-right: 10px;
        }

        .pin-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 300px;
            margin: 30px auto;
        }

        .pin-btn {
            padding: 30px;
            font-size: 2rem;
        }

        .pin-display {
            text-align: center;
            font-size: 3rem;
            letter-spacing: 20px;
            margin: 30px 0;
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
        }
        
        .pin-dots {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 40px 0;
        }
        
        .pin-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid var(--primary-yellow);
            background: transparent;
            transition: all 0.2s ease;
        }
        
        .pin-dot.filled {
            background: var(--primary-yellow);
            box-shadow: 0 0 10px var(--primary-yellow);
            transform: scale(1.1);
        }
        
        /* REVOLUT STYLE PIN */
        .revolut-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .revolut-dot.filled {
            background: #FFD700;
            transform: scale(1.15);
            box-shadow: 0 0 12px rgba(255, 215, 0, 0.5);
        }
        
        .revolut-num-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            color: #ffffff;
            font-family: 'Share Tech Mono', 'Courier New', Courier, monospace;
            font-size: 1.5rem;
            font-weight: 300;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
        }
        
        .revolut-num-btn:active {
            transform: scale(0.92);
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.3);
        }
        
        .revolut-num-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .shake {
            animation: shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97);
        }

        .search-box {
            position: relative;
        }

        .search-results {
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid var(--border-color);
            margin-top: 10px;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.5rem;
            }
            
            .stat-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-add {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .loading {
            text-align: center;
            padding: 50px;
        }

        .loading::after {
            content: '‚ö°';
            font-size: 3rem;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .streak-badge {
            background: linear-gradient(135deg, #00ff00, #00cc00);
            color: var(--dark-bg);
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-size: 1.5rem;
            font-weight: 900;
            box-shadow: 0 0 30px #00ff00;
            animation: glow 2s ease-in-out infinite;
        }
        
        /* WELKOMSTSCHERMEN */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 300;
            transition: opacity 0.5s ease;
        }
        
        .welcome-splash {
            background: #FFD700;
            color: #000000;
        }
        
        .welcome-splash h1 {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            font-size: 8rem;
            color: #000000 !important;
            text-shadow: none !important;
            animation: bolSplash 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            font-weight: 700;
            letter-spacing: -0.05em;
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        
        @keyframes bolSplash {
            0% { 
                opacity: 0;
                transform: scale(0.85);
            }
            100% { 
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .welcome-personal {
            background: var(--dark-bg);
            flex-direction: column;
            padding: 40px;
            text-align: center;
        }
        
        .welcome-personal h2 {
            font-size: 2.5rem;
            margin-bottom: 40px;
            color: var(--primary-yellow);
            animation: fadeInUp 0.8s ease;
        }
        
        .quote {
            font-family: 'Share Tech Mono', 'Courier New', Courier, monospace;
            font-style: italic;
            font-size: 1.2rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
            padding: 30px;
            border-left: 4px solid var(--primary-yellow);
            color: var(--text-secondary);
            opacity: 0;
            animation: fadeInQuote 1s ease 0.5s forwards;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInQuote {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 0.9;
                transform: translateX(0);
            }
        }
        
        .landing-menu {
            background: var(--dark-bg);
            padding: 40px 20px;
            text-align: center;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 500px;
            margin: 40px auto;
        }
        
        .menu-btn {
            background: var(--card-bg);
            border: 3px solid var(--primary-yellow);
            padding: 40px 20px;
            font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-yellow);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .menu-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: var(--primary-yellow);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
            z-index: 0;
        }
        
        .menu-btn:hover::before {
            width: 400px;
            height: 400px;
        }
        
        .menu-btn:hover {
            color: var(--dark-bg);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }
        
        .menu-btn span {
            position: relative;
            z-index: 1;
            display: block;
        }
        
        .menu-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        @media (max-width: 600px) {
            .menu-grid {
                grid-template-columns: 1fr;
            }
            
            .welcome-personal h2 {
                font-size: 2rem;
            }
            
            .quote {
                font-size: 1rem;
                padding: 20px;
            }
        }
    </style>
</head>
<body data-theme="dark">
    
    <button class="theme-toggle" onclick="toggleTheme()">üåì</button>

    <!-- PIN LOCK SCHERM -->
    <div id="pinLock" class="modal" style="background: #0a0a0a;">
        <div style="width: 100%; max-width: 400px; padding: 20px;">
            <!-- Logo/Title area -->
            <div style="text-align: center; margin-bottom: 60px; margin-top: 40px;">
                <div style="font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif; font-size: 1.2rem; font-weight: 700; color: #FFD700; letter-spacing: 3px; margin-bottom: 40px;">
                    BUDGET TRACKER
                </div>
                <p style="font-size: 1rem; color: rgba(255,255,255,0.6); font-weight: 400; margin: 0;" id="pinPromptNew">
                    Enter your passcode
                </p>
            </div>
            
            <!-- PIN Dots - Revolut style -->
            <div style="display: flex; justify-content: center; gap: 20px; margin: 50px 0 80px 0;">
                <div class="revolut-dot" id="revDot1"></div>
                <div class="revolut-dot" id="revDot2"></div>
                <div class="revolut-dot" id="revDot3"></div>
                <div class="revolut-dot" id="revDot4"></div>
            </div>
            
            <!-- Nummerpad - Revolut style -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 280px; margin: 0 auto;">
                <button class="revolut-num-btn" onclick="enterPin('1')">1</button>
                <button class="revolut-num-btn" onclick="enterPin('2')">2</button>
                <button class="revolut-num-btn" onclick="enterPin('3')">3</button>
                <button class="revolut-num-btn" onclick="enterPin('4')">4</button>
                <button class="revolut-num-btn" onclick="enterPin('5')">5</button>
                <button class="revolut-num-btn" onclick="enterPin('6')">6</button>
                <button class="revolut-num-btn" onclick="enterPin('7')">7</button>
                <button class="revolut-num-btn" onclick="enterPin('8')">8</button>
                <button class="revolut-num-btn" onclick="enterPin('9')">9</button>
                <div></div>
                <button class="revolut-num-btn" onclick="enterPin('0')">0</button>
                <button class="revolut-num-btn" onclick="deletePin()" style="font-size: 1.3rem;">‚å´</button>
            </div>
            
            <p style="text-align: center; margin-top: 50px; font-size: 0.85rem; color: rgba(255,255,255,0.3);" id="pinHintNew">
                First time? Set a 4-digit code
            </p>
        </div>
    </div>

    <div id="app" class="hidden">
        <!-- PERSOONLIJK WELKOMSTSCHERM -->
        <div id="welcomePersonal" class="welcome-screen welcome-personal">
            <h2>Welkom Anis...</h2>
            <div class="quote" id="dailyQuote"></div>
            <button style="margin-top: 50px; padding: 15px 40px;" onclick="showLandingMenu()">
                <span>DOORGAAN ‚ûú</span>
            </button>
        </div>
        
        <!-- LANDING MENU -->
        <div id="landingMenu" class="landing-menu hidden">
            <h1 style="margin-bottom: 20px;">BUDGET TRACKER</h1>
            <p style="opacity: 0.7; margin-bottom: 10px;">Kies een sectie</p>
            
            <div class="menu-grid">
                <button class="menu-btn" onclick="navigateToSection('dashboard')">
                    <span>
                        <div class="menu-icon">üè†</div>
                        <div>Dashboard</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('groceries')">
                    <span>
                        <div class="menu-icon">üõí</div>
                        <div>Boodschappen</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('fixed')">
                    <span>
                        <div class="menu-icon">üìã</div>
                        <div>Vaste Lasten</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('spending')">
                    <span>
                        <div class="menu-icon">üí∏</div>
                        <div>Speelruimte</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('savings')">
                    <span>
                        <div class="menu-icon">üí∞</div>
                        <div>Sparen</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('charts')">
                    <span>
                        <div class="menu-icon">üìä</div>
                        <div>Grafieken</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('tools')">
                    <span>
                        <div class="menu-icon">üîß</div>
                        <div>Tools</div>
                    </span>
                </button>
                <button class="menu-btn" onclick="navigateToSection('settings')">
                    <span>
                        <div class="menu-icon">‚öôÔ∏è</div>
                        <div>Instellingen</div>
                    </span>
                </button>
            </div>
        </div>
        
        <div id="mainApp" class="hidden">
        <div class="container">
            <h1>BUDGET TRACKER</h1>

            <!-- DASHBOARD -->
            <div id="dashboardView">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0; color: var(--month-accent) !important; text-shadow: 0 0 10px var(--month-accent); position: relative;" id="monthTitle">
                            SALARISMAAND JANUARI 2026
                            <div style="position: absolute; bottom: -5px; left: 0; right: 0; height: 2px; background: var(--month-accent); opacity: 0.5;"></div>
                        </h2>
                    </div>
                    <select id="monthSelector" style="width: 100%; padding: 12px; margin: 10px 0 20px 0; background: var(--card-bg); color: var(--text-secondary); border: 3px solid var(--month-accent); font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif; font-size: 1rem; font-weight: 700; text-transform: uppercase;">
                        <option value="jan2026">Januari 2026 (9-23 feb)</option>
                        <option value="feb2026">Februari 2026</option>
                        <option value="mar2026">Maart 2026</option>
                        <option value="apr2026">April 2026</option>
                        <option value="may2026">Mei 2026</option>
                        <option value="jun2026">Juni 2026</option>
                        <option value="jul2026">Juli 2026</option>
                        <option value="aug2026">Augustus 2026</option>
                        <option value="sep2026">September 2026</option>
                        <option value="oct2026">Oktober 2026</option>
                        <option value="nov2026">November 2026</option>
                        <option value="dec2026">December 2026</option>
                    </select>
                    <div class="stat-grid">
                        <div class="stat-box">
                            <div class="stat-label">Dagen tot salaris</div>
                            <div class="stat-value" id="daysLeft">15</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Voortgang maand</div>
                            <div class="stat-value" id="monthProgress">0%</div>
                        </div>
                    </div>
                </div>

                <div class="card" id="overviewCard">
                    <h3>üìä OVERZICHT</h3>
                    <div class="stat-grid">
                        <div class="stat-box" style="cursor: pointer;" onclick="editIncome()">
                            <div class="stat-label">Inkomen (klik om aan te passen)</div>
                            <div class="stat-value" id="incomeDisplay">‚Ç¨4.300</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Vaste lasten</div>
                            <div class="stat-value" id="totalFixedDisplay">‚Ç¨2.226</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Speelruimte</div>
                            <div class="stat-value" id="speelruimteLeft">‚Ç¨424</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Totaal gespaard</div>
                            <div class="stat-value" id="totalSavings">‚Ç¨750</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üõí BOODSCHAPPEN VANDAAG</h3>
                    <p style="margin: 10px 0;">Budget: ‚Ç¨35/dag | Gemiddelde: <span id="avgSpending">‚Ç¨32</span>/dag</p>
                    <div class="quick-add">
                        <button class="quick-btn" onclick="quickAddGrocery(25)"><span>‚Ç¨25</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(30)"><span>‚Ç¨30</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(35)"><span>‚Ç¨35</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(40)"><span>‚Ç¨40</span></button>
                    </div>
                    <input type="number" id="customAmount" placeholder="Eigen bedrag..." step="0.01">
                    <input type="text" id="groceryNote" placeholder="Notitie (optioneel)">
                    <button style="width: 100%;" onclick="addGrocery()"><span>TOEVOEGEN</span></button>
                    
                    <div id="todayGrocery" style="margin-top: 20px;"></div>
                </div>

                <div id="streakBadge" class="hidden"></div>
                <div id="achievementBadge" class="hidden"></div>
                <div id="alertBox" class="hidden"></div>
            </div>

            <!-- BOODSCHAPPEN WEEK OVERZICHT -->
            <div id="groceriesView" class="hidden">
                <div class="card">
                    <h2>üõí BOODSCHAPPEN OVERZICHT</h2>
                    
                    <h3>Boodschappen toevoegen</h3>
                    <p style="margin: 10px 0;">Budget: ‚Ç¨35/dag | Gemiddelde: <span id="avgSpendingGroceryTab">‚Ç¨0</span>/dag</p>
                    <div class="quick-add">
                        <button class="quick-btn" onclick="quickAddGrocery(25)"><span>‚Ç¨25</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(30)"><span>‚Ç¨30</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(35)"><span>‚Ç¨35</span></button>
                        <button class="quick-btn" onclick="quickAddGrocery(40)"><span>‚Ç¨40</span></button>
                    </div>
                    <input type="number" id="customAmountGroceryTab" placeholder="Eigen bedrag..." step="0.01">
                    <input type="text" id="groceryNoteGroceryTab" placeholder="Notitie (optioneel)">
                    <button style="width: 100%;" onclick="addGroceryFromTab()"><span>TOEVOEGEN</span></button>
                    
                    <h3 style="margin-top: 30px;">Deze week</h3>
                    <div class="week-grid" id="weekGrid"></div>
                    
                    <h3 style="margin-top: 30px;">Alle dagen deze maand</h3>
                    <div id="allGroceries"></div>
                    
                    <div class="stat-grid" style="margin-top: 20px;">
                        <div class="stat-box">
                            <div class="stat-label">Totaal bespaard</div>
                            <div class="stat-value" id="grocerySaved">‚Ç¨0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Gemiddeld/dag</div>
                            <div class="stat-value" id="avgDaily">‚Ç¨0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VASTE LASTEN -->
            <div id="fixedView" class="hidden">
                <div class="card">
                    <h2>üè† VASTE LASTEN</h2>
                    
                    <h3>Huis (‚Ç¨1.062)</h3>
                    <div id="huisLasten"></div>
                    
                    <h3 style="margin-top: 20px;">Verzekeringen (‚Ç¨202)</h3>
                    <div id="verzekeringenLasten"></div>
                    
                    <h3 style="margin-top: 20px;">Abonnementen (‚Ç¨214)</h3>
                    <div id="abonnementenLasten"></div>
                    
                    <h3 style="margin-top: 20px;">Leningen (‚Ç¨190)</h3>
                    <div id="leningenLasten"></div>
                    
                    <h3 style="margin-top: 20px;">Overig Vast (‚Ç¨208)</h3>
                    <div id="overigLasten"></div>
                    
                    <h3 style="margin-top: 20px;">Vliegtuig (‚Ç¨350)</h3>
                    <div id="vliegtuigLasten"></div>
                    
                    <div class="stat-grid" style="margin-top: 30px;">
                        <div class="stat-box">
                            <div class="stat-label">Totaal vaste lasten</div>
                            <div class="stat-value" id="totalFixed">‚Ç¨2.226</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Na vaste lasten</div>
                            <div class="stat-value" id="afterFixed">‚Ç¨2.074</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SPEELRUIMTE -->
            <div id="spendingView" class="hidden">
                <div class="card">
                    <h2>üí∏ SPEELRUIMTE</h2>
                    <div class="stat-box" style="margin: 20px 0;">
                        <div class="stat-label">Beschikbaar</div>
                        <div class="stat-value" id="speelruimteAvailable">‚Ç¨424</div>
                    </div>
                    
                    <h3>Uitgave toevoegen</h3>
                    <select id="spendingCategory" style="width: 100%; padding: 12px; margin: 10px 0; background: var(--card-bg); color: var(--text-secondary); border: 2px solid var(--border-color); font-family: 'Share Tech Mono', 'Courier New', Courier, monospace; font-size: 1rem;">
                        <option style="background: var(--card-bg); color: var(--text-secondary);">Uit eten</option>
                        <option style="background: var(--card-bg); color: var(--text-secondary);">Kleding</option>
                        <option style="background: var(--card-bg); color: var(--text-secondary);">Spullen</option>
                        <option style="background: var(--card-bg); color: var(--text-secondary);">Overig</option>
                    </select>
                    <input type="number" id="spendingAmount" placeholder="Bedrag..." step="0.01">
                    <input type="text" id="spendingNote" placeholder="Notitie (optioneel)">
                    <button style="width: 100%;" onclick="addSpending()"><span>TOEVOEGEN</span></button>
                    
                    <h3 style="margin-top: 30px;">Uitgaven deze maand</h3>
                    <div id="spendingList"></div>
                    
                    <div class="stat-grid" style="margin-top: 20px;">
                        <div class="stat-box">
                            <div class="stat-label">Totaal uitgegeven</div>
                            <div class="stat-value" id="totalSpent">‚Ç¨0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Gespaard van speelruimte</div>
                            <div class="stat-value" id="speelruimteSaved">‚Ç¨424</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SPAAROVERZICHT -->
            <div id="savingsView" class="hidden">
                <!-- REALTIME SPAARMETER - GROOT SCHERM -->
                <div class="card" style="background: linear-gradient(135deg, rgba(0,255,0,0.15), rgba(0,200,0,0.05)); border: 4px solid #00ff00;">
                    <h2 style="text-align: center; color: #00ff00;">üí∞ REALTIME SPAARMETER</h2>
                    
                    <div style="text-align: center; margin: 40px 0;">
                        <div style="font-size: 5rem; font-weight: 900; color: #00ff00; text-shadow: 0 0 30px #00ff00; margin: 30px 0;" id="realtimeSavingsBig">
                            ‚Ç¨750
                        </div>
                        <div style="font-size: 1.1rem; opacity: 0.9; margin: 20px 0;">
                            <strong>Start:</strong> ‚Ç¨750 | <strong>Auto sparen:</strong> +‚Ç¨600/maand
                        </div>
                    </div>
                    
                    <h3 style="text-align: center; margin: 30px 0 20px 0;">üìä Breakdown deze maand</h3>
                    <div class="stat-grid">
                        <div class="stat-box">
                            <div class="stat-label">Boodschappen</div>
                            <div class="stat-value" id="savingsBoodschappen">‚Ç¨0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Vrij/Speelruimte</div>
                            <div class="stat-value" id="savingsVrij">‚Ç¨0</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 8px; border-left: 4px solid #00ff00;">
                        <p style="font-size: 0.95rem; line-height: 1.6; opacity: 0.9;">
                            <strong>Hoe werkt het?</strong><br>
                            ‚Ä¢ Start bedrag: ‚Ç¨750<br>
                            ‚Ä¢ Elke maand: +‚Ç¨600 automatisch<br>
                            ‚Ä¢ Boodschappen <‚Ç¨35: + verschil<br>
                            ‚Ä¢ Boodschappen >‚Ç¨35: - verschil<br>
                            ‚Ä¢ Vrij onder ‚Ç¨424: + over<br>
                            ‚Ä¢ Vrij boven ‚Ç¨424: - teveel
                        </p>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üìà SPAAROVERZICHT 2026</h2>
                    <div class="stat-box" style="margin: 20px 0;">
                        <div class="stat-label">Totaal gespaard</div>
                        <div class="stat-value" id="totalSavingsView">‚Ç¨1.350</div>
                    </div>
                    
                    <h3>Prognose per maand</h3>
                    <div id="savingsProgression"></div>
                    
                    <h3 style="margin-top: 30px;">Spaarbreakdown</h3>
                    <div class="stat-grid">
                        <div class="stat-box">
                            <div class="stat-label">Start</div>
                            <div class="stat-value">‚Ç¨750</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Auto sparen/maand</div>
                            <div class="stat-value">‚Ç¨600</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Boodschappen bespaard</div>
                            <div class="stat-value" id="grocerySavedTotal">‚Ç¨0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Speelruimte bespaard</div>
                            <div class="stat-value" id="speelruimteSavedTotal">‚Ç¨424</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px;">Spaardoel instellen</h3>
                    <input type="text" id="savingsGoalName" placeholder="Doel (bijv. Vakantie)">
                    <input type="number" id="savingsGoalAmount" placeholder="Bedrag...">
                    <button style="width: 100%;" onclick="setSavingsGoal()"><span>STEL DOEL IN</span></button>
                    
                    <div id="savingsGoalProgress" class="hidden" style="margin-top: 20px;">
                        <h3 id="goalName">Vakantie</h3>
                        <div class="progress-bar">
                            <div class="progress-fill" id="goalProgressBar" style="width: 0%"></div>
                            <div class="progress-text" id="goalProgressText">‚Ç¨0 / ‚Ç¨10.000</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GRAFIEKEN -->
            <div id="chartsView" class="hidden">
                <div class="card">
                    <h2>üìà GRAFIEKEN & ANALYSE</h2>
                    
                    <h3>Uitgaven per categorie</h3>
                    <div class="chart-container">
                        <div class="bar-chart" id="categoryChart"></div>
                    </div>
                    
                    <h3 style="margin-top: 40px;">Maandvergelijking</h3>
                    <div id="monthComparison">
                        <p style="text-align: center; opacity: 0.7; padding: 40px;">
                            Vergelijkingsdata beschikbaar vanaf maart 2026
                        </p>
                    </div>
                    
                    <h3 style="margin-top: 30px;">Zoeken in geschiedenis</h3>
                    <div class="search-box">
                        <input type="text" id="searchQuery" placeholder="Zoek op bedrag, categorie, notitie...">
                        <button style="width: 100%; margin-top: 10px;" onclick="searchHistory()"><span>ZOEKEN</span></button>
                        <div id="searchResults" class="search-results hidden"></div>
                    </div>
                </div>
            </div>

            <!-- TOOLS -->
            <div id="toolsView" class="hidden">
                <div class="card">
                    <h2>üîß TOOLS</h2>
                    
                    <h3>Rekenmachine</h3>
                    <div class="calculator">
                        <div class="calc-display" id="calcDisplay">0</div>
                        <div class="calc-grid">
                            <button class="calc-btn" onclick="calcInput('7')"><span>7</span></button>
                            <button class="calc-btn" onclick="calcInput('8')"><span>8</span></button>
                            <button class="calc-btn" onclick="calcInput('9')"><span>9</span></button>
                            <button class="calc-btn" onclick="calcInput('/')"><span>√∑</span></button>
                            <button class="calc-btn" onclick="calcInput('4')"><span>4</span></button>
                            <button class="calc-btn" onclick="calcInput('5')"><span>5</span></button>
                            <button class="calc-btn" onclick="calcInput('6')"><span>6</span></button>
                            <button class="calc-btn" onclick="calcInput('*')"><span>√ó</span></button>
                            <button class="calc-btn" onclick="calcInput('1')"><span>1</span></button>
                            <button class="calc-btn" onclick="calcInput('2')"><span>2</span></button>
                            <button class="calc-btn" onclick="calcInput('3')"><span>3</span></button>
                            <button class="calc-btn" onclick="calcInput('-')"><span>‚àí</span></button>
                            <button class="calc-btn" onclick="calcInput('0')"><span>0</span></button>
                            <button class="calc-btn" onclick="calcInput('.')"><span>.</span></button>
                            <button class="calc-btn" onclick="calcEqual()"><span>=</span></button>
                            <button class="calc-btn" onclick="calcInput('+')"><span>+</span></button>
                        </div>
                        <button style="width: 100%; margin-top: 10px;" onclick="calcClear()"><span>WISSEN</span></button>
                    </div>
                    
                    <h3 style="margin-top: 30px;">Achievements</h3>
                    <div id="achievementsList"></div>
                    
                    <h3 style="margin-top: 30px;">Export & Backup</h3>
                    <button style="width: 100%; margin: 10px 0;" onclick="exportToPDF()"><span>üìÑ EXPORT NAAR PDF</span></button>
                    <button style="width: 100%; margin: 10px 0;" onclick="backupData()"><span>üíæ BACKUP MAKEN</span></button>
                    <button style="width: 100%; margin: 10px 0;" onclick="resetAllData()"><span>‚ö†Ô∏è ALLES WISSEN</span></button>
                </div>
            </div>

            <!-- INSTELLINGEN -->
            <div id="settingsView" class="hidden">
                <div class="card">
                    <h2>‚öôÔ∏è INSTELLINGEN</h2>
                    
                    <h3>PIN-code wijzigen</h3>
                    <input type="password" id="newPin" placeholder="Nieuwe 4-cijferige code" maxlength="4">
                    <button style="width: 100%; margin: 10px 0;" onclick="changePin()"><span>WIJZIG PIN</span></button>
                    
                    <h3 style="margin-top: 20px;">Meldingen</h3>
                    <div style="margin: 20px 0;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="notificationsEnabled" checked style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-yellow);">
                            <span>Dagelijkse herinnering (22:30)</span>
                        </label>
                    </div>
                    
                    <h3 style="margin-top: 20px;">Thema</h3>
                    <button style="width: 100%; margin: 10px 0;" onclick="toggleTheme()"><span>üåì WISSEL THEMA</span></button>
                    
                    <h3 style="margin-top: 20px;">Over</h3>
                    <p style="opacity: 0.7; line-height: 1.6;">
                        Budget Tracker v1.0<br>
                        Salarismaand gebaseerd budget systeem<br>
                        Gebouwd met ‚ù§Ô∏è door Claude
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Menu button linksboven -->
        <button id="menuBtn" onclick="openMainMenu()" style="position: fixed; top: 20px; left: 20px; z-index: 999; background: var(--card-bg); border: 3px solid var(--border-color); border-radius: 12px; padding: 14px 18px; font-size: 1.5rem; color: var(--text-primary); cursor: pointer; box-shadow: 0 4px 20px rgba(0,0,0,0.4); transition: all 0.3s ease;">
            <span>‚ò∞</span>
        </button>
    </div>

    <script>
        // DATA MODEL
        let appData = {
            pin: null,
            currentMonth: 'jan2026',
            monthColors: {
                jan2026: '#00BFFF',  // Ijsblauw
                feb2026: '#FFD700',  // Geel
                mar2026: '#00FF7F',  // Groen
                apr2026: '#FF69B4',  // Roze
                may2026: '#9370DB',  // Paars
                jun2026: '#FF8C00',  // Oranje
                jul2026: '#FF4500',  // Rood
                aug2026: '#40E0D0',  // Turquoise
                sep2026: '#ADFF2F',  // Lime
                oct2026: '#FF1493',  // Magenta
                nov2026: '#00FFFF',  // Cyan
                dec2026: '#FFD700'   // Goud
            },
            salaryDates: {
                jan2026: new Date('2026-02-09'),  // Speciale start voor januari
                feb2026: new Date('2026-02-24'),
                mar2026: new Date('2026-03-24'),
                apr2026: new Date('2026-04-23'),
                may2026: new Date('2026-05-21'),
                jun2026: new Date('2026-06-24'),
                jul2026: new Date('2026-07-23'),
                aug2026: new Date('2026-08-24'),
                sep2026: new Date('2026-09-24'),
                oct2026: new Date('2026-10-22'),
                nov2026: new Date('2026-11-24'),
                dec2026: new Date('2026-12-23')
            },
            monthEndDates: {
                jan2026: new Date('2026-02-23'),  // Eindigt dag voor februari salaris
                feb2026: new Date('2026-03-23'),
                mar2026: new Date('2026-04-22'),
                apr2026: new Date('2026-05-20'),
                may2026: new Date('2026-06-23'),
                jun2026: new Date('2026-07-22'),
                jul2026: new Date('2026-08-23'),
                aug2026: new Date('2026-09-23'),
                sep2026: new Date('2026-10-21'),
                oct2026: new Date('2026-11-23'),
                nov2026: new Date('2026-12-22'),
                dec2026: new Date('2027-01-22')
            },
            monthNames: {
                jan2026: 'Januari 2026 (9-23 feb)',
                feb2026: 'Februari 2026',
                mar2026: 'Maart 2026',
                apr2026: 'April 2026',
                may2026: 'Mei 2026',
                jun2026: 'Juni 2026',
                jul2026: 'Juli 2026',
                aug2026: 'Augustus 2026',
                sep2026: 'September 2026',
                oct2026: 'Oktober 2026',
                nov2026: 'November 2026',
                dec2026: 'December 2026'
            },
            income: 4300,
            startSavings: 750,
            autoSavePerMonth: 600,
            monthOverrides: {}, // Per maand custom waarden: {jan2026: {income: 4315, fixedCosts: {huis: [{name: 'Water', amount: 18}]}}}
            fixedCosts: {
                huis: [
                    {name: 'Huur', amount: 888, category: 'huis'},
                    {name: 'Energie', amount: 160, category: 'huis'},
                    {name: 'Water', amount: 14, category: 'huis'}
                ],
                verzekeringen: [
                    {name: 'CZ', amount: 191, category: 'verzekeringen'},
                    {name: 'Fietsverzekering', amount: 11, category: 'verzekeringen'}
                ],
                abonnementen: [
                    {name: 'Internet', amount: 25, category: 'abonnementen'},
                    {name: 'Telefoon', amount: 29, category: 'abonnementen'},
                    {name: 'Spotify', amount: 13, category: 'abonnementen'},
                    {name: 'iCloud', amount: 10, category: 'abonnementen'},
                    {name: 'OpenAI', amount: 22, category: 'abonnementen'},
                    {name: 'CapCut', amount: 12, category: 'abonnementen'},
                    {name: 'Gym', amount: 33, category: 'abonnementen'},
                    {name: 'NS', amount: 20, category: 'abonnementen'},
                    {name: 'Urban', amount: 50, category: 'abonnementen'}
                ],
                leningen: [
                    {name: 'Sant', amount: 93, category: 'leningen'},
                    {name: 'Lening', amount: 97, category: 'leningen'}
                ],
                overig: [
                    {name: 'Kapper', amount: 138, category: 'overig'},
                    {name: 'Supplementen', amount: 70, category: 'overig'}
                ],
                vliegtuig: [
                    {name: 'Vlucht', amount: 350, category: 'vliegtuig'}
                ]
            },
            groceryBudget: 35,
            speelruimte: 424,
            groceries: {},
            spending: {},
            achievements: [],
            streak: 0,
            savingsGoal: null
        };

        let currentPin = '';
        let calcValue = '0';

        // QUOTES VAN DE DAG
        const quotes = [
            'Gierig zijn is gewoon: "Ik ben volwassen genoeg om niet elke impuls te adopteren."',
            'Sparen is een superkracht',
            'Ik ben niet gierig, ik ben selectief.',
            'De echte luxe is niet duur doen',
            'niet elke euro meteen op vakantie sturen zonder retourticket',
            'Mensen die alles uitgeven, noemen jou gierig. Dat is alsof een drenkeling lacht om iemand met een zwemdiploma.',
            'Ik heb geen "treat yourself"-momenten.',
            'Ik ben niet goedkoop. Ik ben allergisch voor onzin.',
            '"niet nodig". Dat is de beste deal.',
            'Zuinig zijn is het verschil tussen "ik heb zin" en "ik heb controle".',
            'De winkel wil dat je koopt. Je bankrekening wil dat je ademt. Kies je kamp.',
            'Zuinig zijn is niet bang zijn om arm te worden, maar weigeren om dom te worden.',
            'bezuinigen = schadebeperking',
            'Zuinig zijn is het wantrouwen dat je nodig hebt om niet overal in te trappen.',
            'Sparen is kiezen voor rust in plaats van prikkels die je toch niet vullen.',
            'Wie minder uitgeeft, geeft zichzelf minder kansen op spijt.',
            'De goedkoopste vrijheid is nee zeggen.',
            'Wie uitgeeft alsof morgen vanzelf goedkomt, heeft nog niet lang genoeg geleefd.'
        ];
        
        function getDailyQuote() {
            // Echte random quote elke keer bij inloggen
            const randomIndex = Math.floor(Math.random() * quotes.length);
            return quotes[randomIndex];
        }
        
        // WELKOMSTSCHERM FLOW - BOL.COM STYLE
        function skipWelcome() {
            document.getElementById('welcomeSplash').style.display = 'none';
            document.getElementById('pinLock').classList.remove('hidden');
        }
        
        function startWelcomeFlow() {
            try {
                // 1. Toon geel scherm met B (Bol.com style)
                const welcomeSplash = document.getElementById('welcomeSplash');
                if (!welcomeSplash) {
                    console.error('welcomeSplash not found');
                    document.getElementById('pinLock').classList.remove('hidden');
                    return;
                }
                
                welcomeSplash.style.display = 'flex';
                
                // 2. Na 1.2s smooth fade naar PIN (zoals Bol.com - snel maar smooth)
                setTimeout(() => {
                    welcomeSplash.style.opacity = '0';
                    welcomeSplash.style.transition = 'opacity 0.4s ease-out';
                    setTimeout(() => {
                        welcomeSplash.style.display = 'none';
                        const pinLock = document.getElementById('pinLock');
                        if (pinLock) {
                            pinLock.classList.remove('hidden');
                        }
                    }, 400);
                }, 1200);
            } catch (error) {
                console.error('Welcome flow error:', error);
                // Fallback: direct naar PIN
                document.getElementById('welcomeSplash').style.display = 'none';
                document.getElementById('pinLock').classList.remove('hidden');
            }
        }
        
        function openMainMenu() {
            // Verberg alle views
            ['dashboard', 'groceries', 'fixed', 'spending', 'savings', 'charts', 'tools', 'settings'].forEach(v => {
                document.getElementById(v + 'View').classList.add('hidden');
            });
            
            // Toon landing menu
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('landingMenu').classList.remove('hidden');
        }
        
        function showLandingMenu() {
            document.getElementById('welcomePersonal').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('welcomePersonal').style.display = 'none';
                document.getElementById('landingMenu').classList.remove('hidden');
            }, 300);
        }
        
        function navigateToSection(section) {
            document.getElementById('landingMenu').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            showView(section);
        }

        // INIT
        function init() {
            loadData();
            
            // Direct naar PIN (geen welkomstscherm meer)
            // PIN scherm is al zichtbaar (geen hidden class)
            
            // Setup month selector
            const monthSelector = document.getElementById('monthSelector');
            if (monthSelector) {
                monthSelector.value = appData.currentMonth;
                monthSelector.addEventListener('change', function() {
                    changeMonth(this.value);
                });
            }
            
            updateMonthColor();
            updateDashboard();
            updateRealtimeSavings(); // Init spaar meter
            initFixedCosts();
            updateIncomeDisplay();
            requestNotificationPermission();
            scheduleReminder();
        }
        
        // MONTH FUNCTIONS
        function changeMonth(monthKey) {
            appData.currentMonth = monthKey;
            saveData();
            updateMonthColor();
            updateDashboard();
            updateRealtimeSavings(); // Update spaar meter
            
            // Update all views
            updateGroceriesView();
            updateSpendingView();
            updateSavingsView();
            updateChartsView();
            initFixedCosts();
            updateIncomeDisplay();
            
            // Show appropriate cards for january
            if (monthKey === 'jan2026') {
                document.getElementById('overviewCard').style.display = 'none';
            } else {
                document.getElementById('overviewCard').style.display = 'block';
            }
        }
        
        function updateMonthColor() {
            const color = appData.monthColors[appData.currentMonth];
            const root = document.documentElement;
            
            // Update ALLE primaire kleuren naar maandkleur
            root.style.setProperty('--month-accent', color);
            root.style.setProperty('--primary-yellow', color);
            root.style.setProperty('--border-color', color);
            root.style.setProperty('--text-primary', color);
            
            // Update title
            const title = appData.monthNames[appData.currentMonth];
            document.getElementById('monthTitle').innerHTML = `
                SALARISMAAND ${title.toUpperCase()}
                <div style="position: absolute; bottom: -5px; left: 0; right: 0; height: 2px; background: ${color}; opacity: 0.5;"></div>
            `;
        }

        // LOCAL STORAGE
        function saveData() {
            localStorage.setItem('budgetAppData', JSON.stringify(appData));
        }

        function loadData() {
            const saved = localStorage.getItem('budgetAppData');
            if (saved) {
                const parsed = JSON.parse(saved);
                // Merge om nieuwe velden te behouden
                appData = {...appData, ...parsed};
                // Convert date strings back to Date objects
                Object.keys(appData.salaryDates).forEach(key => {
                    appData.salaryDates[key] = new Date(appData.salaryDates[key]);
                });
                if (appData.monthEndDates) {
                    Object.keys(appData.monthEndDates).forEach(key => {
                        appData.monthEndDates[key] = new Date(appData.monthEndDates[key]);
                    });
                }
            }
        }
        
        // REALTIME SPAAR METER
        function updateRealtimeSavings() {
            let totalSavings = 750; // Start bedrag
            
            // Tel alle maanden tot en met huidige maand
            const monthOrder = ['jan2026', 'feb2026', 'mar2026', 'apr2026', 'may2026', 'jun2026', 'jul2026', 'aug2026', 'sep2026', 'oct2026', 'nov2026', 'dec2026'];
            const currentIndex = monthOrder.indexOf(appData.currentMonth);
            
            for (let i = 0; i <= currentIndex; i++) {
                const month = monthOrder[i];
                
                // +‚Ç¨600 auto save per maand (behalve januari)
                if (month !== 'jan2026') {
                    totalSavings += 600;
                }
                
                // Boodschappen savings/overschrijding
                const groceries = appData.groceries[month] || {};
                Object.values(groceries).forEach(entry => {
                    const diff = appData.groceryBudget - entry.amount;
                    totalSavings += diff; // Positief = besparing, negatief = overschrijding
                });
                
                // Speelruimte over/teveel uitgegeven
                const spending = appData.spending[month] || [];
                const totalSpent = spending.reduce((sum, s) => sum + s.amount, 0);
                const speelruimteLeft = appData.speelruimte - totalSpent;
                if (speelruimteLeft > 0) {
                    totalSavings += speelruimteLeft; // Over = bij sparen
                } else {
                    totalSavings += speelruimteLeft; // Negatief = van sparen af
                }
            }
            
            // Update display (alle 3 locaties)
            const savingsBigEl = document.getElementById('realtimeSavingsBig');
            
            if (savingsBigEl) {
                savingsBigEl.textContent = `‚Ç¨${totalSavings.toFixed(0)}`;
                
                // Kleur: groen als >= 750, rood als < 750
                if (totalSavings >= 750) {
                    savingsBigEl.style.color = '#00ff00';
                    savingsBigEl.style.textShadow = '0 0 30px #00ff00';
                } else {
                    savingsBigEl.style.color = '#ff3333';
                    savingsBigEl.style.textShadow = '0 0 30px #ff3333';
                }
            }
            
            // Update breakdown
            const currentGroceries = appData.groceries[appData.currentMonth] || {};
            let grocerySavings = 0;
            Object.values(currentGroceries).forEach(entry => {
                grocerySavings += (appData.groceryBudget - entry.amount);
            });
            
            const currentSpending = appData.spending[appData.currentMonth] || [];
            const totalSpent = currentSpending.reduce((sum, s) => sum + s.amount, 0);
            const speelruimteSavings = appData.speelruimte - totalSpent;
            
            const boodschappenEl = document.getElementById('savingsBoodschappen');
            const vrijEl = document.getElementById('savingsVrij');
            
            if (boodschappenEl) {
                boodschappenEl.textContent = `‚Ç¨${grocerySavings.toFixed(0)}`;
                boodschappenEl.style.color = grocerySavings >= 0 ? '#00ff00' : '#ff3333';
            }
            
            if (vrijEl) {
                vrijEl.textContent = `‚Ç¨${speelruimteSavings.toFixed(0)}`;
                vrijEl.style.color = speelruimteSavings >= 0 ? '#00ff00' : '#ff3333';
            }
        }

        // PIN FUNCTIES
        function enterPin(num) {
            if (currentPin.length < 4) {
                currentPin += num;
                updatePinDisplay();
                
                // Auto-check zodra 4 cijfers zijn ingevuld
                if (currentPin.length === 4) {
                    setTimeout(() => {
                        checkPin();
                    }, 100);
                }
            }
        }

        function deletePin() {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
        }

        function clearPin() {
            currentPin = '';
            updatePinDisplay();
        }

        function updatePinDisplay() {
            // Update Revolut-style dots
            for (let i = 1; i <= 4; i++) {
                const dot = document.getElementById('revDot' + i);
                if (dot) {
                    if (i <= currentPin.length) {
                        dot.classList.add('filled');
                    } else {
                        dot.classList.remove('filled');
                    }
                }
            }
        }

        function checkPin() {
            if (!appData.pin) {
                // Eerste keer - stel pin in
                if (currentPin.length === 4) {
                    appData.pin = currentPin;
                    saveData();
                    unlockApp();
                }
            } else {
                // Check pin
                if (currentPin === appData.pin) {
                    unlockApp();
                } else {
                    // Shake animatie bij foute code - Revolut stijl
                    const pinContainer = document.querySelector('#pinLock > div');
                    pinContainer.classList.add('shake');
                    
                    // Alle dots rood maken even
                    for (let i = 1; i <= 4; i++) {
                        const dot = document.getElementById('revDot' + i);
                        if (dot) {
                            dot.style.background = '#ff4444';
                        }
                    }
                    
                    // Vibratie (als beschikbaar)
                    if (navigator.vibrate) {
                        navigator.vibrate([50, 50, 50]);
                    }
                    
                    setTimeout(() => {
                        pinContainer.classList.remove('shake');
                        currentPin = '';
                        updatePinDisplay();
                        
                        // Reset dot colors
                        for (let i = 1; i <= 4; i++) {
                            const dot = document.getElementById('revDot' + i);
                            if (dot) {
                                dot.style.background = '';
                            }
                        }
                        
                        const prompt = document.getElementById('pinPromptNew');
                        if (prompt) {
                            prompt.textContent = 'Wrong passcode, try again';
                            prompt.style.color = '#ff4444';
                            
                            setTimeout(() => {
                                prompt.textContent = 'Enter your passcode';
                                prompt.style.color = '';
                            }, 2000);
                        }
                    }, 500);
                }
            }
        }

        function unlockApp() {
            document.getElementById('pinLock').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('pinLock').classList.add('hidden');
                document.getElementById('pinLock').style.opacity = '1';
                document.getElementById('app').classList.remove('hidden');
                currentPin = '';
                updatePinDisplay();
                
                // Toon persoonlijk welkomstscherm met quote
                const quote = getDailyQuote();
                document.getElementById('dailyQuote').textContent = quote;
                document.getElementById('welcomePersonal').style.display = 'flex';
            }, 300);
        }

        function changePin() {
            const newPin = document.getElementById('newPin').value;
            if (newPin.length === 4 && /^\d+$/.test(newPin)) {
                appData.pin = newPin;
                saveData();
                alert('PIN-code gewijzigd!');
                document.getElementById('newPin').value = '';
            } else {
                alert('Voer een 4-cijferige code in');
            }
        }

        // NAVIGATIE
        function showView(view) {
            // Hide all views
            ['dashboard', 'groceries', 'fixed', 'spending', 'savings', 'charts', 'tools', 'settings'].forEach(v => {
                document.getElementById(v + 'View').classList.add('hidden');
            });
            // Show selected view
            document.getElementById(view + 'View').classList.remove('hidden');
            
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.nav-btn').classList.add('active');
            
            // Update view-specific data
            if (view === 'groceries') updateGroceriesView();
            if (view === 'savings') updateSavingsView();
            if (view === 'charts') updateChartsView();
            if (view === 'tools') updateToolsView();
            if (view === 'spending') updateSpendingView();
        }

        // DASHBOARD
        function updateDashboard() {
            const today = new Date();
            const salaryDate = appData.salaryDates[appData.currentMonth];
            const isJanuary = appData.currentMonth === 'jan2026';
            
            let daysLeft, totalDays, currentDay, nextSalaryDate;
            
            if (isJanuary) {
                // Januari: 9 feb t/m 23 feb (15 dagen vast)
                const janStartDate = new Date('2026-02-09');
                const febSalaryDate = new Date('2026-02-24');
                
                // Dagen tot februari salaris (24 feb)
                const msPerDay = 1000 * 60 * 60 * 24;
                const diffMs = febSalaryDate - today;
                daysLeft = Math.max(0, Math.ceil(diffMs / msPerDay));
                
                // Totaal dagen in januari = altijd 15
                totalDays = 15;
                
                // Huidige dag in januari (9 feb = dag 1)
                const startMs = today - janStartDate;
                const daysPassed = Math.floor(startMs / msPerDay);
                
                if (daysPassed < 0) {
                    // Voor 9 feb
                    currentDay = 0;
                } else if (daysPassed >= 15) {
                    // Na 23 feb
                    currentDay = 15;
                } else {
                    // Tussen 9 en 23 feb
                    currentDay = daysPassed + 1; // +1 omdat 9 feb = dag 1
                }
            } else {
                nextSalaryDate = getNextSalaryDate();
                
                // Calculate days
                if (today < salaryDate) {
                    // We zijn nog voor deze salarismaand - toon dagen tot salaris
                    daysLeft = Math.ceil((salaryDate - today) / (1000 * 60 * 60 * 24));
                    totalDays = daysLeft;
                    currentDay = 0;
                } else {
                    // We zitten in de salarismaand
                    daysLeft = Math.ceil((nextSalaryDate - today) / (1000 * 60 * 60 * 24));
                    totalDays = Math.ceil((nextSalaryDate - salaryDate) / (1000 * 60 * 60 * 24));
                    currentDay = totalDays - daysLeft;
                }
            }
            
            const progress = totalDays > 0 ? (currentDay / totalDays) * 100 : 0;
            
            document.getElementById('daysLeft').textContent = daysLeft;
            document.getElementById('monthProgress').textContent = Math.round(progress) + '%';
            document.getElementById('monthProgressBar').style.width = progress + '%';
            
            if (isJanuary) {
                document.querySelector('.progress-text').textContent = `Dag ${currentDay} van ${totalDays} (tot feb salaris)`;
            } else {
                document.querySelector('.progress-text').textContent = `Dag ${currentDay} van ${totalDays}`;
            }
            
            // Update totals
            updateTotals();
            
            // Check achievements
            checkAchievements();
            
            // Update streak
            updateStreak();
        }

        function getNextSalaryDate() {
            const today = new Date();
            const monthKeys = Object.keys(appData.salaryDates);
            for (let key of monthKeys) {
                if (appData.salaryDates[key] > today) {
                    return appData.salaryDates[key];
                }
            }
            return appData.salaryDates[monthKeys[monthKeys.length - 1]];
        }

        function updateTotals() {
            const isJanuary = appData.currentMonth === 'jan2026';
            
            // Calculate groceries saved
            let grocerySaved = 0;
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            Object.values(currentMonthGroceries).forEach(g => {
                grocerySaved += (appData.groceryBudget - g.amount);
            });
            
            if (isJanuary) {
                // Januari: alleen boodschappen tellen, geen speelruimte/sparen
                document.getElementById('speelruimteLeft').textContent = '-';
                document.getElementById('totalSavings').textContent = '‚Ç¨' + grocerySaved.toFixed(0);
            } else {
                // Normale maanden
                // Calculate spending
                let totalSpent = 0;
                const currentMonthSpending = appData.spending[appData.currentMonth] || [];
                currentMonthSpending.forEach(s => {
                    totalSpent += s.amount;
                });
                
                const speelruimteLeft = appData.speelruimte - totalSpent;
                const speelruimteSaved = speelruimteLeft;
                
                // Total savings - include january savings if exists
                const januarySavings = calculateJanuarySavings();
                const totalSavings = appData.startSavings + appData.autoSavePerMonth + grocerySaved + speelruimteSaved + januarySavings;
                
                document.getElementById('speelruimteLeft').textContent = '‚Ç¨' + speelruimteLeft.toFixed(0);
                document.getElementById('totalSavings').textContent = '‚Ç¨' + totalSavings.toFixed(0);
            }
            
            // Average spending
            const daysWithGroceries = Object.keys(currentMonthGroceries).length;
            const avgSpending = daysWithGroceries > 0 
                ? Object.values(currentMonthGroceries).reduce((sum, g) => sum + g.amount, 0) / daysWithGroceries 
                : 0;
            document.getElementById('avgSpending').textContent = '‚Ç¨' + avgSpending.toFixed(0);
            
            // Check for today's grocery entry
            const todayKey = formatDate(new Date());
            if (currentMonthGroceries[todayKey]) {
                const entry = currentMonthGroceries[todayKey];
                const diff = appData.groceryBudget - entry.amount;
                const isOverBudget = diff < 0;
                const isUnderBudget = diff > 0;
                
                document.getElementById('todayGrocery').innerHTML = `
                    <div class="stat-box" style="margin-top: 20px; border: 3px solid ${isOverBudget ? 'var(--warning)' : isUnderBudget ? 'var(--success)' : 'var(--border-color)'}; background: ${isOverBudget ? 'rgba(255, 51, 51, 0.1)' : isUnderBudget ? 'rgba(0, 255, 0, 0.1)' : 'var(--card-bg)'};">
                        <div class="stat-label">Vandaag uitgegeven</div>
                        <div class="stat-value" style="color: ${isOverBudget ? 'var(--warning)' : isUnderBudget ? 'var(--success)' : 'var(--primary-yellow)'};">‚Ç¨${entry.amount.toFixed(2)}</div>
                        <div style="margin-top: 15px; font-size: 1.3rem; font-weight: 700; color: ${diff >= 0 ? 'var(--success)' : 'var(--warning)'}; text-shadow: 0 0 10px ${diff >= 0 ? 'var(--success)' : 'var(--warning)'};">
                            ${diff >= 0 ? '‚úì ‚Ç¨' + diff.toFixed(2) + ' GESPAARD!' : '‚úó ‚Ç¨' + Math.abs(diff).toFixed(2) + ' TE VEEL!'}
                        </div>
                        ${diff >= 0 ? '<div style="margin-top: 10px; color: var(--success); font-size: 0.9rem;">üí∞ Gaat naar sparen</div>' : '<div style="margin-top: 10px; color: var(--warning); font-size: 0.9rem;">‚ö†Ô∏è Komt van sparen</div>'}
                        ${entry.note ? '<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border-color); opacity: 0.7;">' + entry.note + '</div>' : ''}
                    </div>
                `;
            } else {
                document.getElementById('todayGrocery').innerHTML = '<p style="text-align: center; opacity: 0.7; margin-top: 20px;">Nog geen invoer vandaag</p>';
            }
        }
        
        function calculateJanuarySavings() {
            // Calculate januari boodschappen savings to add to februari+
            const januaryGroceries = appData.groceries['jan2026'] || {};
            let januarySaved = 0;
            Object.values(januaryGroceries).forEach(g => {
                januarySaved += (appData.groceryBudget - g.amount);
            });
            return januarySaved;
        }

        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // BOODSCHAPPEN
        function quickAddGrocery(amount) {
            document.getElementById('customAmount').value = amount;
            document.getElementById('customAmountGroceryTab').value = amount;
        }

        function addGrocery() {
            const amount = parseFloat(document.getElementById('customAmount').value);
            const note = document.getElementById('groceryNote').value;
            
            if (!amount || amount <= 0) {
                alert('Voer een geldig bedrag in');
                return;
            }
            
            const today = formatDate(new Date());
            
            if (!appData.groceries[appData.currentMonth]) {
                appData.groceries[appData.currentMonth] = {};
            }
            
            appData.groceries[appData.currentMonth][today] = {
                amount: amount,
                note: note,
                date: new Date()
            };
            
            saveData();
            updateDashboard();
            updateGroceriesView();
            updateRealtimeSavings(); // Update spaar meter
            
            document.getElementById('customAmount').value = '';
            document.getElementById('groceryNote').value = '';
            
            // Check notifications for over/under budget
            const diff = appData.groceryBudget - amount;
            
            if (amount > appData.groceryBudget) {
                // Over budget - show warning
                const overAmount = Math.abs(diff);
                showNotification('‚ö†Ô∏è Budget overschreden!', 
                    `Je gaat ‚Ç¨${overAmount.toFixed(2)} over budget! Probeer morgen minder uit te geven.`, 
                    'warning');
            } else if (diff >= 10) {
                // Saved ‚Ç¨10+ - show positive message
                showNotification('üí∞ Goed bezig!', 
                    `Top! ‚Ç¨${diff.toFixed(2)} bespaard vandaag!`, 
                    'success');
            }
        }
        
        function addGroceryFromTab() {
            const amount = parseFloat(document.getElementById('customAmountGroceryTab').value);
            const note = document.getElementById('groceryNoteGroceryTab').value;
            
            if (!amount || amount <= 0) {
                alert('Voer een geldig bedrag in');
                return;
            }
            
            const today = formatDate(new Date());
            
            if (!appData.groceries[appData.currentMonth]) {
                appData.groceries[appData.currentMonth] = {};
            }
            
            appData.groceries[appData.currentMonth][today] = {
                amount: amount,
                note: note,
                date: new Date()
            };
            
            saveData();
            updateDashboard();
            updateGroceriesView();
            updateRealtimeSavings(); // Update spaar meter
            
            document.getElementById('customAmountGroceryTab').value = '';
            document.getElementById('groceryNoteGroceryTab').value = '';
            
            // Check notifications
            const diff = appData.groceryBudget - amount;
            
            if (amount > appData.groceryBudget) {
                const overAmount = Math.abs(diff);
                showNotification('‚ö†Ô∏è Budget overschreden!', 
                    `Je gaat ‚Ç¨${overAmount.toFixed(2)} over budget! Probeer morgen minder uit te geven.`, 
                    'warning');
            } else if (diff >= 10) {
                showNotification('üí∞ Goed bezig!', 
                    `Top! ‚Ç¨${diff.toFixed(2)} bespaard vandaag!`, 
                    'success');
            }
        }
        
        // EDIT & DELETE BOODSCHAPPEN
        function editGrocery(dateKey) {
            const entry = appData.groceries[appData.currentMonth][dateKey];
            if (!entry) return;
            
            const newAmount = prompt('Nieuw bedrag:', entry.amount);
            if (newAmount === null) return; // Canceled
            
            const amount = parseFloat(newAmount);
            if (isNaN(amount) || amount <= 0) {
                alert('Voer een geldig bedrag in');
                return;
            }
            
            const newNote = prompt('Notitie (optioneel):', entry.note || '');
            
            appData.groceries[appData.currentMonth][dateKey] = {
                amount: amount,
                note: newNote,
                date: entry.date
            };
            
            saveData();
            updateDashboard();
            updateGroceriesView();
            updateRealtimeSavings();
        }
        
        function deleteGrocery(dateKey) {
            if (!confirm('Weet je zeker dat je deze boodschappen wilt verwijderen?')) {
                return;
            }
            
            delete appData.groceries[appData.currentMonth][dateKey];
            
            saveData();
            updateDashboard();
            updateGroceriesView();
            updateRealtimeSavings();
        }

        function updateGroceriesView() {
            // Week grid
            const weekGrid = document.getElementById('weekGrid');
            weekGrid.innerHTML = '';
            
            const today = new Date();
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateKey = formatDate(date);
                const dayName = ['Zo', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Za'][date.getDay()];
                
                const entry = currentMonthGroceries[dateKey];
                let className = 'day-cell';
                let content = `<div style="font-weight: 700;">${dayName}</div><div style="font-size: 0.7rem; opacity: 0.8;">${date.getDate()}</div>`;
                
                if (entry) {
                    const diff = appData.groceryBudget - entry.amount;
                    if (diff > 0) {
                        className += ' under-budget';
                        content += `<div style="margin-top: 5px; font-weight: 900; font-size: 0.9rem;">‚Ç¨${entry.amount}</div>`;
                        content += `<div style="font-size: 0.7rem; margin-top: 2px;">-‚Ç¨${diff.toFixed(0)}</div>`;
                    } else if (diff < 0) {
                        className += ' over-budget';
                        content += `<div style="margin-top: 5px; font-weight: 900; font-size: 0.9rem;">‚Ç¨${entry.amount}</div>`;
                        content += `<div style="font-size: 0.7rem; margin-top: 2px;">+‚Ç¨${Math.abs(diff).toFixed(0)}</div>`;
                    } else {
                        content += `<div style="margin-top: 5px; font-weight: 700; color: var(--primary-yellow);">‚Ç¨${entry.amount}</div>`;
                        content += `<div style="font-size: 0.7rem; margin-top: 2px;">Exact!</div>`;
                    }
                } else {
                    content += `<div style="margin-top: 5px; opacity: 0.3;">-</div>`;
                }
                
                if (dateKey === formatDate(today)) {
                    className += ' today';
                }
                
                weekGrid.innerHTML += `<div class="${className}">${content}</div>`;
            }
            
            // All groceries
            const allGroceries = document.getElementById('allGroceries');
            allGroceries.innerHTML = '';
            
            const entries = Object.entries(currentMonthGroceries).reverse();
            entries.forEach(([dateKey, entry]) => {
                const date = new Date(dateKey);
                const diff = appData.groceryBudget - entry.amount;
                const isOver = diff < 0;
                const isUnder = diff > 0;
                
                allGroceries.innerHTML += `
                    <div class="list-item" style="border-left: 4px solid ${isOver ? 'var(--warning)' : isUnder ? 'var(--success)' : 'var(--border-color)'}; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 700;">${date.toLocaleDateString('nl-NL', {weekday: 'short', day: 'numeric', month: 'short'})}</div>
                            ${entry.note ? '<div style="opacity: 0.7; font-size: 0.9rem;">' + entry.note + '</div>' : ''}
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="text-align: right;">
                                <div style="font-weight: 700; color: var(--primary-yellow); font-size: 1.1rem;">‚Ç¨${entry.amount.toFixed(2)}</div>
                                <div style="font-size: 0.9rem; font-weight: 700; color: ${diff >= 0 ? 'var(--success)' : 'var(--warning)'};">
                                    ${diff >= 0 ? '‚úì ' : '‚úó '}${diff >= 0 ? '-' : '+'}‚Ç¨${Math.abs(diff).toFixed(2)}
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <button onclick="editGrocery('${dateKey}')" style="padding: 6px 10px; font-size: 0.8rem; background: var(--card-bg); border: 2px solid var(--border-color); color: var(--text-primary); cursor: pointer; border-radius: 4px;">‚úèÔ∏è</button>
                                <button onclick="deleteGrocery('${dateKey}')" style="padding: 6px 10px; font-size: 0.8rem; background: var(--card-bg); border: 2px solid var(--warning); color: var(--warning); cursor: pointer; border-radius: 4px;">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            // Update stats
            let totalSaved = 0;
            let totalSpent = 0;
            Object.values(currentMonthGroceries).forEach(g => {
                totalSpent += g.amount;
                totalSaved += (appData.groceryBudget - g.amount);
            });
            
            const avgDaily = entries.length > 0 ? totalSpent / entries.length : 0;
            
            document.getElementById('grocerySaved').textContent = '‚Ç¨' + totalSaved.toFixed(0);
            document.getElementById('avgDaily').textContent = '‚Ç¨' + avgDaily.toFixed(0);
            
            // Update grocery tab average too
            const avgSpendingElem = document.getElementById('avgSpendingGroceryTab');
            if (avgSpendingElem) {
                avgSpendingElem.textContent = '‚Ç¨' + avgDaily.toFixed(0);
            }
        }

        // VASTE LASTEN
        function initFixedCosts() {
            const categories = ['huis', 'verzekeringen', 'abonnementen', 'leningen', 'overig', 'vliegtuig'];
            
            categories.forEach(cat => {
                const container = document.getElementById(cat + 'Lasten');
                container.innerHTML = '';
                
                appData.fixedCosts[cat].forEach((item, index) => {
                    // Check if there's a month-specific override
                    const overrideAmount = getMonthOverride('fixedCosts', cat, item.name);
                    const displayAmount = overrideAmount !== null ? overrideAmount : item.amount;
                    const isOverridden = overrideAmount !== null;
                    
                    container.innerHTML += `
                        <div class="list-item">
                            <div>
                                <span class="category-tag">${item.category}</span>
                                ${item.name}
                            </div>
                            <div>
                                ‚Ç¨<input type="number" class="editable" value="${displayAmount}" 
                                    onchange="updateFixedCost('${cat}', ${index}, '${item.name}', this.value)" 
                                    step="0.01"
                                    style="${isOverridden ? 'color: var(--success); font-weight: 900;' : ''}">
                            </div>
                        </div>
                    `;
                });
            });
            
            updateFixedTotals();
        }
        
        function getMonthOverride(type, category, itemName) {
            const monthData = appData.monthOverrides[appData.currentMonth];
            if (!monthData) return null;
            
            if (type === 'income') {
                return monthData.income || null;
            }
            
            if (type === 'fixedCosts' && monthData.fixedCosts && monthData.fixedCosts[category]) {
                const override = monthData.fixedCosts[category].find(item => item.name === itemName);
                return override ? override.amount : null;
            }
            
            return null;
        }
        
        function setMonthOverride(type, value, category = null, itemName = null) {
            if (!appData.monthOverrides[appData.currentMonth]) {
                appData.monthOverrides[appData.currentMonth] = {};
            }
            
            if (type === 'income') {
                appData.monthOverrides[appData.currentMonth].income = value;
            } else if (type === 'fixedCosts') {
                if (!appData.monthOverrides[appData.currentMonth].fixedCosts) {
                    appData.monthOverrides[appData.currentMonth].fixedCosts = {};
                }
                if (!appData.monthOverrides[appData.currentMonth].fixedCosts[category]) {
                    appData.monthOverrides[appData.currentMonth].fixedCosts[category] = [];
                }
                
                // Remove existing override for this item
                appData.monthOverrides[appData.currentMonth].fixedCosts[category] = 
                    appData.monthOverrides[appData.currentMonth].fixedCosts[category].filter(item => item.name !== itemName);
                
                // Add new override
                appData.monthOverrides[appData.currentMonth].fixedCosts[category].push({
                    name: itemName,
                    amount: value
                });
            }
            
            saveData();
        }

        function updateFixedCost(category, index, itemName, newValue) {
            const amount = parseFloat(newValue);
            const defaultAmount = appData.fixedCosts[category][index].amount;
            
            // If different from default, save as override
            if (amount !== defaultAmount) {
                setMonthOverride('fixedCosts', amount, category, itemName);
            } else {
                // If same as default, remove override
                removeMonthOverride('fixedCosts', category, itemName);
            }
            
            updateFixedTotals();
            updateDashboard();
            initFixedCosts(); // Refresh to show color
        }
        
        function removeMonthOverride(type, category = null, itemName = null) {
            const monthData = appData.monthOverrides[appData.currentMonth];
            if (!monthData) return;
            
            if (type === 'fixedCosts' && monthData.fixedCosts && monthData.fixedCosts[category]) {
                monthData.fixedCosts[category] = monthData.fixedCosts[category].filter(item => item.name !== itemName);
            }
            
            saveData();
        }

        function updateFixedTotals() {
            let total = 0;
            const categories = ['huis', 'verzekeringen', 'abonnementen', 'leningen', 'overig', 'vliegtuig'];
            
            categories.forEach(cat => {
                appData.fixedCosts[cat].forEach(item => {
                    const overrideAmount = getMonthOverride('fixedCosts', cat, item.name);
                    const amount = overrideAmount !== null ? overrideAmount : item.amount;
                    total += amount;
                });
            });
            
            // Get current income (with override if exists)
            const currentIncome = getCurrentIncome();
            
            document.getElementById('totalFixed').textContent = '‚Ç¨' + total.toFixed(0);
            document.getElementById('afterFixed').textContent = '‚Ç¨' + (currentIncome - total).toFixed(0);
            
            // Update dashboard display
            const totalFixedElem = document.getElementById('totalFixedDisplay');
            if (totalFixedElem) {
                totalFixedElem.textContent = '‚Ç¨' + total.toFixed(0);
            }
        }
        
        function getCurrentIncome() {
            const overrideIncome = getMonthOverride('income');
            return overrideIncome !== null ? overrideIncome : appData.income;
        }
        
        function editIncome() {
            const currentIncome = getCurrentIncome();
            const newIncome = prompt('Inkomen aanpassen voor ' + appData.monthNames[appData.currentMonth] + ':', currentIncome);
            
            if (newIncome !== null && newIncome !== '') {
                const amount = parseFloat(newIncome);
                if (!isNaN(amount) && amount > 0) {
                    if (amount !== appData.income) {
                        setMonthOverride('income', amount);
                    } else {
                        // Remove override if back to default
                        if (appData.monthOverrides[appData.currentMonth]) {
                            delete appData.monthOverrides[appData.currentMonth].income;
                            saveData();
                        }
                    }
                    updateIncomeDisplay();
                    updateFixedTotals();
                    updateDashboard();
                } else {
                    alert('Voer een geldig bedrag in');
                }
            }
        }
        
        function updateIncomeDisplay() {
            const currentIncome = getCurrentIncome();
            const isOverridden = getMonthOverride('income') !== null;
            const elem = document.getElementById('incomeDisplay');
            if (elem) {
                elem.textContent = '‚Ç¨' + currentIncome.toLocaleString('nl-NL');
                elem.style.color = isOverridden ? 'var(--success)' : 'var(--primary-yellow)';
                elem.style.fontWeight = isOverridden ? '900' : '700';
            }
        }

        // SPEELRUIMTE
        function addSpending() {
            const category = document.getElementById('spendingCategory').value;
            const amount = parseFloat(document.getElementById('spendingAmount').value);
            const note = document.getElementById('spendingNote').value;
            
            if (!amount || amount <= 0) {
                alert('Voer een geldig bedrag in');
                return;
            }
            
            // Waarschuwing bij grote uitgave
            if (amount > 50) {
                if (!confirm(`Grote uitgave van ‚Ç¨${amount.toFixed(2)}! Weet je het zeker?`)) {
                    return; // Cancel if user says no
                }
            }
            
            if (!appData.spending[appData.currentMonth]) {
                appData.spending[appData.currentMonth] = [];
            }
            
            appData.spending[appData.currentMonth].push({
                category: category,
                amount: amount,
                note: note,
                date: new Date()
            });
            
            saveData();
            updateDashboard();
            updateSpendingView();
            updateRealtimeSavings(); // Update spaar meter
            
            document.getElementById('spendingAmount').value = '';
            document.getElementById('spendingNote').value = '';
            
            // Check speelruimte warnings
            const totalSpent = appData.spending[appData.currentMonth].reduce((sum, s) => sum + s.amount, 0);
            const remaining = appData.speelruimte - totalSpent;
            
            if (remaining <= 200) {
                showNotification('üö® Kritiek!', 
                    `Nog maar ‚Ç¨${remaining.toFixed(0)} speelruimte over! Pas op met uitgaven.`, 
                    'critical');
            } else if (remaining <= 250) {
                showNotification('‚ö†Ô∏è Waarschuwing!', 
                    `Nog ‚Ç¨${remaining.toFixed(0)} speelruimte over. Let op je uitgaven!`, 
                    'warning');
            } else if (remaining <= 300) {
                showNotification('‚ö†Ô∏è Pas op!', 
                    `Nog ‚Ç¨${remaining.toFixed(0)} speelruimte over.`, 
                    'warning');
            } else if (remaining <= 350) {
                showNotification('üí° Let op!', 
                    `Nog ‚Ç¨${remaining.toFixed(0)} speelruimte over.`, 
                    'info');
            }
        }
        
        // EDIT & DELETE SPENDING
        function editSpending(index) {
            const entry = appData.spending[appData.currentMonth][index];
            if (!entry) return;
            
            const newAmount = prompt('Nieuw bedrag:', entry.amount);
            if (newAmount === null) return; // Canceled
            
            const amount = parseFloat(newAmount);
            if (isNaN(amount) || amount <= 0) {
                alert('Voer een geldig bedrag in');
                return;
            }
            
            const newNote = prompt('Notitie (optioneel):', entry.note || '');
            
            appData.spending[appData.currentMonth][index] = {
                category: entry.category,
                amount: amount,
                note: newNote,
                date: entry.date
            };
            
            saveData();
            updateDashboard();
            updateSpendingView();
            updateRealtimeSavings();
        }
        
        function deleteSpending(index) {
            if (!confirm('Weet je zeker dat je deze uitgave wilt verwijderen?')) {
                return;
            }
            
            appData.spending[appData.currentMonth].splice(index, 1);
            
            saveData();
            updateDashboard();
            updateSpendingView();
            updateRealtimeSavings();
        }

        function updateSpendingView() {
            const currentMonthSpending = appData.spending[appData.currentMonth] || [];
            const list = document.getElementById('spendingList');
            list.innerHTML = '';
            
            currentMonthSpending.slice().reverse().forEach((item, reverseIndex) => {
                const actualIndex = currentMonthSpending.length - 1 - reverseIndex; // Get actual index in original array
                const date = new Date(item.date);
                list.innerHTML += `
                    <div class="list-item" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <span class="category-tag">${item.category}</span>
                            <div style="margin-top: 5px;">${date.toLocaleDateString('nl-NL')}</div>
                            ${item.note ? '<div style="opacity: 0.7; font-size: 0.9rem;">' + item.note + '</div>' : ''}
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-weight: 700; color: var(--warning);">‚Ç¨${item.amount.toFixed(2)}</div>
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <button onclick="editSpending(${actualIndex})" style="padding: 6px 10px; font-size: 0.8rem; background: var(--card-bg); border: 2px solid var(--border-color); color: var(--text-primary); cursor: pointer; border-radius: 4px;">‚úèÔ∏è</button>
                                <button onclick="deleteSpending(${actualIndex})" style="padding: 6px 10px; font-size: 0.8rem; background: var(--card-bg); border: 2px solid var(--warning); color: var(--warning); cursor: pointer; border-radius: 4px;">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            const totalSpent = currentMonthSpending.reduce((sum, s) => sum + s.amount, 0);
            const speelruimteLeft = appData.speelruimte - totalSpent;
            
            document.getElementById('totalSpent').textContent = '‚Ç¨' + totalSpent.toFixed(0);
            document.getElementById('speelruimteSaved').textContent = '‚Ç¨' + speelruimteLeft.toFixed(0);
            document.getElementById('speelruimteAvailable').textContent = '‚Ç¨' + speelruimteLeft.toFixed(0);
        }

        // SPAREN
        function updateSavingsView() {
            // Calculate total savings
            let grocerySaved = 0;
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            Object.values(currentMonthGroceries).forEach(g => {
                grocerySaved += (appData.groceryBudget - g.amount);
            });
            
            let totalSpent = 0;
            const currentMonthSpending = appData.spending[appData.currentMonth] || [];
            currentMonthSpending.forEach(s => {
                totalSpent += s.amount;
            });
            const speelruimteSaved = appData.speelruimte - totalSpent;
            
            // Add januari savings
            const januarySavings = calculateJanuarySavings();
            const totalSavings = appData.startSavings + appData.autoSavePerMonth + grocerySaved + speelruimteSaved + januarySavings;
            
            document.getElementById('totalSavingsView').textContent = '‚Ç¨' + totalSavings.toFixed(0);
            document.getElementById('grocerySavedTotal').textContent = '‚Ç¨' + (grocerySaved + januarySavings).toFixed(0);
            document.getElementById('speelruimteSavedTotal').textContent = '‚Ç¨' + speelruimteSaved.toFixed(0);
            
            // Progression
            const progression = document.getElementById('savingsProgression');
            progression.innerHTML = '';
            
            // Add januari first
            progression.innerHTML += `
                <div class="list-item" style="border-left: 4px solid #00BFFF;">
                    <div>
                        <div style="font-weight: 700;">Jan 2026</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">Alleen boodschappen (15 dagen)</div>
                    </div>
                    <div style="font-weight: 700; color: var(--success);">‚Ç¨${januarySavings.toFixed(0)}</div>
                </div>
            `;
            
            const months = [
                {name: 'Feb', key: 'feb2026'}, 
                {name: 'Mrt', key: 'mar2026'}, 
                {name: 'Apr', key: 'apr2026'}, 
                {name: 'Mei', key: 'may2026'}, 
                {name: 'Jun', key: 'jun2026'}, 
                {name: 'Jul', key: 'jul2026'}, 
                {name: 'Aug', key: 'aug2026'}, 
                {name: 'Sep', key: 'sep2026'}, 
                {name: 'Okt', key: 'oct2026'}, 
                {name: 'Nov', key: 'nov2026'}, 
                {name: 'Dec', key: 'dec2026'}
            ];
            let runningTotal = appData.startSavings + januarySavings;
            
            months.forEach((month, index) => {
                if (month.key === appData.currentMonth) {
                    // Huidige maand - actuele besparing
                    runningTotal += appData.autoSavePerMonth + grocerySaved + speelruimteSaved;
                } else {
                    // Andere maanden - alleen auto sparen
                    runningTotal += appData.autoSavePerMonth;
                }
                
                const isCurrent = month.key === appData.currentMonth;
                progression.innerHTML += `
                    <div class="list-item" style="${isCurrent ? 'border-left: 4px solid var(--month-accent);' : ''}">
                        <div>
                            <div style="font-weight: 700;">${month.name} 2026</div>
                            ${isCurrent ? '<div style="font-size: 0.8rem; opacity: 0.7;">Huidige maand</div>' : '<div style="font-size: 0.8rem; opacity: 0.7;">Prognose</div>'}
                        </div>
                        <div style="font-weight: 700; color: var(--success);">‚Ç¨${runningTotal.toFixed(0)}</div>
                    </div>
                `;
            });
            
            // Update goal if exists
            if (appData.savingsGoal) {
                document.getElementById('savingsGoalProgress').classList.remove('hidden');
                document.getElementById('goalName').textContent = appData.savingsGoal.name;
                const goalProgress = (totalSavings / appData.savingsGoal.amount) * 100;
                document.getElementById('goalProgressBar').style.width = Math.min(goalProgress, 100) + '%';
                document.getElementById('goalProgressText').textContent = 
                    `‚Ç¨${totalSavings.toFixed(0)} / ‚Ç¨${appData.savingsGoal.amount.toFixed(0)}`;
            }
        }

        function setSavingsGoal() {
            const name = document.getElementById('savingsGoalName').value;
            const amount = parseFloat(document.getElementById('savingsGoalAmount').value);
            
            if (!name || !amount || amount <= 0) {
                alert('Voer een naam en bedrag in');
                return;
            }
            
            appData.savingsGoal = {name, amount};
            saveData();
            updateSavingsView();
            
            document.getElementById('savingsGoalName').value = '';
            document.getElementById('savingsGoalAmount').value = '';
        }

        // GRAFIEKEN
        function updateChartsView() {
            // Category chart
            const chart = document.getElementById('categoryChart');
            chart.innerHTML = '';
            
            const categories = {};
            const currentMonthSpending = appData.spending[appData.currentMonth] || [];
            currentMonthSpending.forEach(s => {
                categories[s.category] = (categories[s.category] || 0) + s.amount;
            });
            
            const maxValue = Math.max(...Object.values(categories), 1);
            
            Object.entries(categories).forEach(([cat, amount]) => {
                const height = (amount / maxValue) * 100;
                chart.innerHTML += `
                    <div class="bar" style="height: ${height}%">
                        <div class="bar-value">‚Ç¨${amount.toFixed(0)}</div>
                        <div class="bar-label">${cat}</div>
                    </div>
                `;
            });
            
            if (Object.keys(categories).length === 0) {
                chart.innerHTML = '<p style="text-align: center; width: 100%; opacity: 0.7;">Nog geen uitgaven deze maand</p>';
            }
        }

        function searchHistory() {
            const query = document.getElementById('searchQuery').value.toLowerCase();
            if (!query) return;
            
            const results = document.getElementById('searchResults');
            results.innerHTML = '';
            results.classList.remove('hidden');
            
            let found = false;
            
            // Search in groceries
            Object.entries(appData.groceries).forEach(([month, entries]) => {
                Object.entries(entries).forEach(([date, entry]) => {
                    if (entry.amount.toString().includes(query) || 
                        (entry.note && entry.note.toLowerCase().includes(query))) {
                        results.innerHTML += `
                            <div class="list-item">
                                <div>
                                    <span class="category-tag">Boodschappen</span>
                                    ${new Date(date).toLocaleDateString('nl-NL')}
                                    ${entry.note ? '<div style="opacity: 0.7;">' + entry.note + '</div>' : ''}
                                </div>
                                <div style="font-weight: 700;">‚Ç¨${entry.amount.toFixed(2)}</div>
                            </div>
                        `;
                        found = true;
                    }
                });
            });
            
            // Search in spending
            Object.entries(appData.spending).forEach(([month, entries]) => {
                entries.forEach(entry => {
                    if (entry.amount.toString().includes(query) || 
                        entry.category.toLowerCase().includes(query) ||
                        (entry.note && entry.note.toLowerCase().includes(query))) {
                        results.innerHTML += `
                            <div class="list-item">
                                <div>
                                    <span class="category-tag">${entry.category}</span>
                                    ${new Date(entry.date).toLocaleDateString('nl-NL')}
                                    ${entry.note ? '<div style="opacity: 0.7;">' + entry.note + '</div>' : ''}
                                </div>
                                <div style="font-weight: 700;">‚Ç¨${entry.amount.toFixed(2)}</div>
                            </div>
                        `;
                        found = true;
                    }
                });
            });
            
            if (!found) {
                results.innerHTML = '<p style="padding: 20px; text-align: center; opacity: 0.7;">Geen resultaten gevonden</p>';
            }
        }

        // ACHIEVEMENTS
        function checkAchievements() {
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            const entries = Object.values(currentMonthGroceries);
            
            // 5 dagen onder budget
            const underBudgetDays = entries.filter(e => e.amount < appData.groceryBudget).length;
            if (underBudgetDays === 5 && !hasAchievement('5_days_under')) {
                addAchievement('5_days_under', 'üèÜ 5 dagen onder budget!');
            }
            
            // 10 dagen ingevuld
            if (entries.length === 10 && !hasAchievement('10_days_filled')) {
                addAchievement('10_days_filled', '‚≠ê 10 dagen ingevuld!');
            }
            
            // ‚Ç¨100 gespaard
            const saved = entries.reduce((sum, e) => sum + (appData.groceryBudget - e.amount), 0);
            if (saved >= 100 && !hasAchievement('100_saved')) {
                addAchievement('100_saved', 'üí∞ ‚Ç¨100 bespaard!');
            }
            
            // Superstar levels - check consecutive days under ‚Ç¨30
            checkSuperstarAchievements();
        }
        
        function checkSuperstarAchievements() {
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            
            // Get sorted dates
            const sortedDates = Object.keys(currentMonthGroceries).sort();
            
            // Count consecutive days under ‚Ç¨30
            let consecutiveDays = 0;
            let maxConsecutive = 0;
            
            for (let i = 0; i < sortedDates.length; i++) {
                const entry = currentMonthGroceries[sortedDates[i]];
                
                if (entry.amount < 30) {
                    consecutiveDays++;
                    maxConsecutive = Math.max(maxConsecutive, consecutiveDays);
                } else {
                    consecutiveDays = 0;
                }
            }
            
            // Award achievements based on consecutive days
            if (maxConsecutive >= 7 && !hasAchievement('superstar_legend')) {
                addAchievement('superstar_legend', 'üëë Superstar Legend! HELD! Een hele week onder ‚Ç¨30! Je bent een legende! üèÜ');
            } else if (maxConsecutive >= 6 && !hasAchievement('superstar_pro')) {
                addAchievement('superstar_pro', 'üåü Superstar Pro! Bijna een hele week! Je hebt dit! üíé');
            } else if (maxConsecutive >= 5 && !hasAchievement('superstar_elite')) {
                addAchievement('superstar_elite', '‚≠ê Superstar Elite! Ongelooflijk! Je bent echt bezig! üî•');
            } else if (maxConsecutive >= 4 && !hasAchievement('superstar')) {
                addAchievement('superstar', 'üí´ Superstar! Je bent op de goede weg! Keep going! üí™');
            }
        }

        function hasAchievement(id) {
            return appData.achievements.some(a => a.id === id);
        }

        function addAchievement(id, text) {
            appData.achievements.push({id, text, date: new Date()});
            saveData();
            showAchievement(text);
        }

        function showAchievement(text) {
            const badge = document.getElementById('achievementBadge');
            badge.textContent = text;
            badge.classList.remove('hidden');
            badge.className = 'achievement';
            
            setTimeout(() => {
                badge.classList.add('hidden');
            }, 5000);
        }

        function updateToolsView() {
            const list = document.getElementById('achievementsList');
            list.innerHTML = '';
            
            if (appData.achievements.length === 0) {
                list.innerHTML = '<p style="text-align: center; opacity: 0.7; padding: 20px;">Nog geen achievements behaald</p>';
            } else {
                appData.achievements.slice().reverse().forEach(ach => {
                    list.innerHTML += `<div class="badge">${ach.text}</div>`;
                });
            }
        }

        // STREAK
        function updateStreak() {
            const today = formatDate(new Date());
            const yesterday = formatDate(new Date(Date.now() - 86400000));
            
            const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
            
            if (currentMonthGroceries[today]) {
                if (currentMonthGroceries[yesterday] || appData.streak === 0) {
                    appData.streak++;
                }
            } else {
                if (!currentMonthGroceries[yesterday] && appData.streak > 0) {
                    appData.streak = 0;
                }
            }
            
            if (appData.streak >= 5) {
                const badge = document.getElementById('streakBadge');
                badge.textContent = `üî• ${appData.streak} dagen streak!`;
                badge.classList.remove('hidden');
                badge.className = 'streak-badge';
            }
            
            saveData();
        }

        // ALERTS
        function showAlert(text) {
            const alert = document.getElementById('alertBox');
            alert.textContent = text;
            alert.classList.remove('hidden');
            alert.className = 'alert';
            
            setTimeout(() => {
                alert.classList.add('hidden');
            }, 5000);
        }
        
        // NOTIFICATIONS
        function showNotification(title, message, type = 'info') {
            // Color scheme based on type
            const colors = {
                success: { bg: 'linear-gradient(135deg, #00ff00, #00cc00)', color: '#000000', icon: 'üí∞' },
                warning: { bg: 'linear-gradient(135deg, #ff9500, #ff6600)', color: '#000000', icon: '‚ö†Ô∏è' },
                critical: { bg: 'linear-gradient(135deg, #ff3333, #cc0000)', color: '#ffffff', icon: 'üö®' },
                info: { bg: 'linear-gradient(135deg, #FFD700, #FFA500)', color: '#000000', icon: 'üí°' }
            };
            
            const style = colors[type] || colors.info;
            
            // Create notification popup
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                left: 50%;
                transform: translateX(-50%);
                background: ${style.bg};
                color: ${style.color};
                padding: 20px 30px;
                border-radius: 12px;
                font-family: 'Orbitron', 'Impact', 'Arial Black', sans-serif;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
                z-index: 1001;
                max-width: 85%;
                animation: slideDown 0.5s ease;
            `;
            
            notification.innerHTML = `
                <div style="font-size: 1.2rem; font-weight: 900; margin-bottom: 8px;">
                    ${style.icon} ${title}
                </div>
                <div style="font-size: 0.9rem; font-weight: 400; font-family: 'Share Tech Mono', 'Courier New', Courier, monospace; line-height: 1.4;">
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Vibrate based on type
            if (navigator.vibrate) {
                if (type === 'critical') {
                    navigator.vibrate([200, 100, 200, 100, 200]);
                } else if (type === 'warning') {
                    navigator.vibrate([150, 50, 150]);
                } else if (type === 'success') {
                    navigator.vibrate([100, 50, 100]);
                } else {
                    navigator.vibrate(100);
                }
            }
            
            // Auto dismiss after 4 seconds
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.5s ease';
                setTimeout(() => notification.remove(), 500);
            }, 4000);
        }

        // CALCULATOR
        function calcInput(val) {
            if (calcValue === '0') {
                calcValue = val;
            } else {
                calcValue += val;
            }
            document.getElementById('calcDisplay').textContent = calcValue;
        }

        function calcEqual() {
            try {
                calcValue = eval(calcValue).toString();
                document.getElementById('calcDisplay').textContent = calcValue;
            } catch (e) {
                document.getElementById('calcDisplay').textContent = 'ERROR';
                calcValue = '0';
            }
        }

        function calcClear() {
            calcValue = '0';
            document.getElementById('calcDisplay').textContent = calcValue;
        }

        // THEME
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            body.setAttribute('data-theme', currentTheme === 'dark' ? 'light' : 'dark');
            localStorage.setItem('theme', currentTheme === 'dark' ? 'light' : 'dark');
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.body.setAttribute('data-theme', savedTheme);
        }

        // NOTIFICATIONS
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function scheduleReminder() {
            const now = new Date();
            const reminder = new Date();
            reminder.setHours(22, 0, 0, 0); // 22:00 uur
            
            if (now > reminder) {
                reminder.setDate(reminder.getDate() + 1);
            }
            
            const timeUntilReminder = reminder - now;
            
            setTimeout(() => {
                if (document.getElementById('notificationsEnabled').checked) {
                    // Check of boodschappen vandaag zijn ingevuld
                    const today = formatDate(new Date());
                    const currentMonthGroceries = appData.groceries[appData.currentMonth] || {};
                    
                    if (!currentMonthGroceries[today]) {
                        // Geen boodschappen ingevuld vandaag - stuur reminder
                        if ('Notification' in window && Notification.permission === 'granted') {
                            new Notification('Budget Tracker üí∞', {
                                body: 'Vergeet niet je boodschappen van vandaag in te vullen! üõí',
                                icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23FFD700"/><text x="50" y="70" font-size="60" text-anchor="middle" fill="%23000">B</text></svg>',
                                tag: 'daily-reminder',
                                requireInteraction: false
                            });
                        } else {
                            // Fallback: in-app notification
                            showNotification('üí∞ Budget Tracker', 
                                'Vergeet niet je boodschappen van vandaag in te vullen! üõí', 
                                'info');
                        }
                    }
                }
                // Schedule next day
                scheduleReminder();
            }, timeUntilReminder);
        }
        }

        // EXPORT
        function exportToPDF() {
            alert('PDF export wordt gegeneerd... (feature in ontwikkeling)');
            // Would implement actual PDF generation here
        }

        function backupData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `budget-backup-${formatDate(new Date())}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function resetAllData() {
            if (confirm('Weet je zeker dat je ALLE data wilt wissen? Dit kan niet ongedaan gemaakt worden!')) {
                if (confirm('Laatste waarschuwing! ALLES wordt gewist.')) {
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        // START APP
        init();
    </script>
</body>
</html>